<!DOCTYPE html>
<html>
<head >
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
        ::-webkit-scrollbar
        {
            margin-top: 7px;
            width: 5px;
        }

        ::-webkit-scrollbar-thumb
        {
            transition: background-color .3s;
            border-radius: 200px;
        }
        ::-webkit-scrollbar:hover {
            width: 15px;
        }
        body, html {
            overflow: hidden;
        }
        nav {
            box-shadow: none;
        }
        main {
            padding: 10px 5px 64px 5px;
            height: calc(100vh - 128px);
            overflow-y: scroll;
        }
        .chat-bubble-wrapper {
            width: 100%;
            display: block;
            white-space: wrap;
            clear: both;
        }
        .chat-bubble {
            padding: 8px;
            background-attachment: fixed;
            border-radius: 3px;
            margin-bottom: 7px;
            display: inline-block;
        }
        .chat-bubble-title {
            padding: 2px;
            display: inline-block;
            font-size: 12px;
        }
        .chat-bubble.self {
            float: right;
        }


    </style>
    <style id="dark-styles">
        html, body {
            color: #fff;
        }
        label {
            color: #eceff1 !important;
        }
        [type="radio"]:not(:checked)+label:before, [type="radio"]:not(:checked)+label:after {
            border: 2px solid #eceff1;
        }
        [type="radio"]:checked+label:after, [type="radio"].with-gap:checked+label:before, [type="radio"].with-gap:checked+label:after {
            border: 2px solid #ffc107;
        }
        [type="radio"]:checked+label:after, [type="radio"].with-gap:checked+label:after {
            border: 1px solid #ffc107;
            background-color: #ffc107;
        }

        .progress {
            background-color: #607d8b
        }
        .progress .determinate, .progress .indeterminate {
            background-color: #ffc107
        }

        .collection {
            background-color: #90a4ae !important;
            border: none;
        }
        .collection-item {
            background-color: #90a4ae !important;
        }
        a.btn-flat {
            color: #fff;
        }
        ::-webkit-scrollbar-track
        {
            background-color: #607d8b;
        }

        ::-webkit-scrollbar
        {
            background-color: transparent;
        }

        ::-webkit-scrollbar-thumb
        {
            background-color: rgba(0,0,0,.3);
        }
        ::-webkit-scrollbar-thumb:hover
        {
            background-color: rgba(255,193,7, .5);
        }
        nav {
            background-color: #455a64;
        }
        main {
            background-color: #607d8b;
        }
        .chat-bubble {
            background-color: #fff;
            color: #050505;
        }
        .chat-bubble-title {
            color: #fff;
        }
        .chat-bubble.self {
            background-color: #00bcd4;
            color: #fff;
        }
        .modal-content {
            background-color: #607d8b;
        }
        .modal .modal-footer {
            background-color: #455a64;
        }
        .side-nav {
            background-color: #607d8b;
        }
        .side-nav li a {
            color: #fff;
        }
        .side-nav li a.subheader {
            color: #b0bec5 !important;
        }
        .divider {
            background-color: #90a4ae;
        }
        span.badge.new {
            background-color: #ff6f00;
        }



    </style>

    <!-- LIGHT STYLE -->

    <style id="light-styles">
        html, body {
            color: #000;
        }

        .progress {
            background-color: #e0e0e0;
        }
        .progress .determinate, .progress .indeterminate {
            background-color: #00bcd4;
        }

        ::-webkit-scrollbar-track
        {
            background-color: #fff;
        }

        ::-webkit-scrollbar
        {
            background-color: transparent;
        }

        ::-webkit-scrollbar-thumb
        {
            background-color: rgba(0,0,0,.3);
        }
        ::-webkit-scrollbar-thumb:hover
        {
            background-color: #4caf50;
        }
        nav {
            background-color: #00bcd4;
        }
        main {
            background-color: #fff;
        }
        .chat-bubble {
            background-color: #607d8b;
            color: #fff;
        }
        .chat-bubble-title {
            color: #000;
        }
        .chat-bubble.self {
            background-color: #4dd0e1;
            color: #000;
        }
        .modal-content {
            background-color: #fff;
        }


    </style>
</head>

<body>
<div id="fs_cover" style="position:fixed;height:100vh;width:100vw;background-color: #263238;z-index:99999;"></div>
<ul id="add_dropdown" class="dropdown-content">
    <li><a class="modal-trigger" href="#create-group-modal">New Group</a></li>
    <li><a class="modal-trigger" href="#add-user-modal">Add User</a></li>
</ul>
<div class="navbar-fixed">
    <nav>
        <div class="nav-wrapper">
            <ul class="left">
                <li><a style="margin-left:0px;" href="#" data-activates="group_list" class="button-collapse show-on-large"><i class="material-icons">menu</i></a></li>
            </ul>
            <a class="brand-logo hide-on-small-only">Test Group Please Ignore</a>
            <ul class="right">
                <li><a href="#settings-modal" class="modal-trigger"><span class="hide-on-med-and-down">Settings </span><i class="material-icons right">settings</i></a></li>
                <li><a href="#tasks_modal" class="modal-trigger"><span class="hide-on-med-and-down">Background Tasks </span><i class="material-icons right">cached</i></a></li>
                <li><a class="dropdown-button" href="#!" data-activates="add_dropdown"><span class="hide-on-med-and-down">Add Group </span><i class="material-icons right">add</i></a></li>
            </ul>
        </div>
    </nav>
</div>
<ul class="side-nav" id="group_list">
    <li><a>Your Address: <span class="user_ip_display"></span></a></li>
    <li><div class="divider"></div></li>
    <li><a class="subheader">Groups</a></li>
    <div class="groups">
        <li><a id="group-lol">Test Group</a></li>
    </div>
</ul>
<main>
    <div class="chat-bubble-wrapper"><div class="chat-bubble-title">
        <span class="content">Miles</span>
    </div></div>
    <div class="chat-bubble-wrapper"><div class="chat-bubble">
        <span class="content">Test Text</span>
    </div></div>
    <div class="chat-bubble-wrapper"><div class="chat-bubble self">
        <span class="content">Test Text</span>
    </div></div>
</main>

<div style="bottom:0px;position:fixed;width:100vw;">
    <nav>
        <div class="nav-wrapper">
            <input id="message-input-bar" style="height: 64px; width: 92%; margin-left: 5%;" class="text-color">
        </div>
    </nav>
</div>


<div id="tasks_modal" class="modal bottom-sheet modal-fixed-footer">
    <div class="modal-content">
        <h4>Background Tasks</h4>
        <ul class="collection">
            <li class="collection-item avatar">
                <i class="material-icons circle orange">wifi</i>
                <span class="title">Connecting to Edric Bulan</span>
                <p>Getting details<br>
                <div class="progress">
                    <div class="indeterminate"></div>
                </div>
                </p>
            </li>
            <li class="collection-item avatar">
                <i class="material-icons circle green">lock_outline</i>
                <span class="title">Establishing secure connection to Luke</span>
                <p>Awaiting response with security token<br>
                <div class="progress">
                    <div class="indeterminate"></div>
                </div>
                </p>
            </li>
            <li class="collection-item avatar">
                <i class="material-icons circle">folder_shared</i>
                <span class="title">Sending file to Miles</span>
                <p>60% (610Mb/1Gb)<br>
                <div class="progress">
                    <div class="determinate" style="width: 60%;"></div>
                </div>
                </p>
            </li>
        </ul>
    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
    </div>
</div>

<div id="settings-modal" class="modal bottom-sheet modal-fixed-footer">
    <div class="modal-content">
        <h4>Settings</h4>
        <p>Colour Scheme</p>
        <form action="#">
            <p>
                <input name="theme" class="with-gap" type="radio" id="enable-light-mode" />
                <label for="enable-light-mode">Light Mode</label>
            </p>
            <p>
                <input name="theme" class="with-gap" type="radio" id="enable-dark-mode" checked />
                <label for="enable-dark-mode">Dark Mode</label>
            </p>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
    </div>
</div>

<div id="create-group-modal" class="modal">
    <div class="modal-content">
        <h4>New Group</h4>
        <div class="row">
            <form class="col s12">
                <div class="row">
                    <div class="input-field col s12 m6">
                        <input id="group-name-input" type="text" class="validate">
                        <label for="group-name-input">Group Name</label>
                    </div>
                    <div class="col s12 m6">
                        <div class="chips chips-autocomplete"></div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="modal-footer">
        <a href="#!" style="margin-right: 5px;" class="modal-action modal-close waves-effect waves-red btn-flat">Close</a>
        <a href="#!" class="modal-action modal-close waves-effect waves-light btn green">Create</a>
    </div>
</div>

<div id="add-user-modal" class="modal">
    <div class="modal-content">
        <h4>New Group</h4>
        <div class="row">
            <form class="col s12">
                <div class="row">
                    <div class="input-field col s12 m6">
                        <input id="user-ip-input" type="text" class="validate">
                        <label for="user-ip-input">User IP Address</label>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="modal-footer">
        <a href="#!" style="margin-right: 5px;" class="modal-action modal-close waves-effect waves-red btn-flat">Close</a>
        <a id="add-user-modal-confirm" class="modal-action modal-close waves-effect waves-light btn green">Connect</a>
    </div>
</div>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
<!--
SETUP
-->
<script>
    $("#message-input-bar").keypress(function(e) {
        if(e.which == 13) {
            $(this).val("");
        }
    });
</script>
<script>
$.fn.exists = function () {
    return this.length !== 0;
}
$(document).ready(function() {
        document.getElementById('dark-styles').disabled = false;
        document.getElementById('light-styles').disabled = true;
        $(".button-collapse").sideNav();
        $(".main-color").addClass("blue-grey");
        $(".text-color").addClass("white-text");
        $('.modal').modal();
        $(".dropdown-button").dropdown();
        external.dom_ready();
    });

    $(document).ready(function() {
  $(window).keydown(function(event){
    if(event.keyCode == 13) {
      event.preventDefault();
      return false;
    }
  });
});

function switch_css(off_target, on_target) {
        $("#fs_cover").fadeIn(500);
        setTimeout(function() {
            off_target.disabled = true;
            on_target.disabled = false;
        }, 500);
        setTimeout(function() {
            $("#fs_cover").fadeOut(500);
        }, 600);

    }

$("#enable-light-mode").change(function() {
        if (this.checked) {
            $("#fs_cover").css("background-color", "#ffffff");
            switch_css(document.getElementById('dark-styles'), document.getElementById('light-styles'))
        }
    });

    $("#enable-dark-mode").change(function() {
        if (this.checked) {
            $("#fs_cover").css("background-color", "#263238");
            switch_css(document.getElementById('light-styles'), document.getElementById('dark-styles'))
        }
    });


</script>
<!--
FROM PYTHON
-->
<script>
var last_sender = "";
function hide_loader() {
    $("#fs_cover").hide();
}

    function display_message_received(sender, message, self) {
        if (typeof(self) === 'undefined') self = false;
        if (last_sender != sender) {
            last_sender = sender;
            if (!self) {
                $("main").append('<div class="chat-bubble-wrapper"><div class="chat-bubble-title"><span class="content">' + sender + '</span></div></div>');
            }
        }
        $("main").append('<div class="chat-bubble-wrapper"><div class="chat-bubble' + (self ? ' self' : '') + '"><span class="content">' + message + '</span></div></div>');
    }

function notify_message_received(sender, message, groupid, groupname, notoast) {
    var badge = $("#group-"+groupid+" .new.badge");
    if (!badge.exists()) {
        $("#group-"+groupid).append('<span class="new badge">0</span>');
        badge = $("#group-"+groupid+" .new.badge");
    }
    $("#group-"+groupid+" .new.badge").html(parseInt($("#group-"+groupid+" .new.badge").html())+1);
    if (notoast) {return;}
    var $toastContent = $('<span>Message from '+sender+' in '+groupname+'</span>').add($('<button class="btn-flat toast-action notification_action_view">View</button>'));
    Materialize.toast($toastContent, 10000);

}
</script>
<!--
TO PYTHON
-->
<script>
    $(window).blur(function() {
        external.set_blur(true);
    });
    $(window).focus(function() {
        external.set_blur(false);
    });
</script>

</body>
</html>